# Export tables to Excel

## Export tables to Excel


There are several ways to export R objects to Excel. We will use here the the `write.xslx()` function of the `openxlsx` package.

 It takes a matrix or data frame object as input and saves it as a `.xlsx` file.

`write.xslx()` is one of the most common functions, but there are many other functions that allow you to export formatted tables to Microsoft Excel, Word or PowerPoint. Here are some examples:

  * huxtable and jtools
  * ReporteRs
  * Flextable
  * r2excel (only available in GitHub).

## Export tables to Excel

### `write.xlsx(x, file, row.names = TRUE, col.names ...)` 
  
 * __x__:	the object to be written
 * __file__: where to save the table, i.e., the file path including the file name
 * __row.names__: a logical value indicating whether the row names of x are to be written along with x

## Export tables to Excel

### Exercise 9

Use the `write.xlsx()` function to save the `happy_table` you table created in Exercise 4 into an xlsx file.

1. Set `x` argument as *happy_table*.
2. Set `file` as the folder path to your output folder including a name for the file plus ".xlsx"

 TIP:
 
 * Use the help function to check syntax if needed

## Export tables to Excel
\scriptsize

```{r, include = T, eval = F}
write.xlsx(happy_table,
           file = file.path(YourFilePathObject, "happy_table.xlsx"))

```


\begin{figure}[H]
  \centering
  \includegraphics[scale=.7]{img/happy_table_xlsx.png}
\end{figure}


# Export regression table

## Export regression table

\begin{block}{Warning:}
This is a session on \textbf{descriptive} analysis, so regressions are beyond its scope.
\end{block}

But since you'll probably ask, here's how you 

```{r}
# Run a Regression
reg1 <- lm(Sepal.Length ~ Sepal.Width,
           data = iris)

```

[^2]: `iris` is a built in data set in R with some morphology information for the flowers of 3 iris species.

## Export regression table
\scriptsize


```{r, eval = F}
# Export a regression table

depvar_label <- "Sepal Length"
covar_labels <- "Sepal Width"

stargazer(reg1,
          title = "Regression table",
          dep.var.labels = depvar_label,
          covariate.labels = covar_labels,
          digits = 2,
          # out = "..."
          header = F)

```



## Export regression table
\tiny

```{r, results ='asis', echo = F}
# Export a regression table
depvar_label <- "Sepal Length"
covar_labels <- "Sepal Width"

stargazer(reg1,
          title = "Regression table",
          dep.var.labels = depvar_label,
          covariate.labels = covar_labels,
          digits = 2,
          header = F)

```



## Export regression table
\scriptsize

```{r}

# Regression 1
reg1 <- lm(Sepal.Length ~ Sepal.Width,
           data = iris)

# Reg with two indep vars
reg2 <- lm(Sepal.Length ~ Sepal.Width + Petal.Length,
           data = iris)

# Reg with two indep vars and species FE
reg3 <- lm(Sepal.Length ~ Sepal.Width + Petal.Length + factor(Species),
           data = iris)

```

## Export regression table
\scriptsize

```{r, eval = F}
depvar_label <- "Sepal Length"
covar_labels <- c("Sepal Width",
                  "Petal Length")
#Table
stargazer(reg1,
          reg2,
          reg3,
          font.size = "tiny",
          title = "Regression table",
          keep = c("Sepal.Width",  "Petal.Length"),
          dep.var.labels = depvar_label,
          covariate.labels = covar_labels,
          add.lines = list(
            c("Species FE", "No", "No", "Yes")
            ),
          omit.stat = c("ser"),
          digits = 2,
          header = F)
```

## Export regression table
\scriptsize

```{r, results ='asis', echo = F}
depvar_label <- "Sepal Length"
covar_labels <- c("Sepal Width",
                  "Petal Length")
#Table
stargazer(reg1,
          reg2,
          reg3,
          font.size = "tiny",
          title = "Regression table",
          keep = c("Sepal.Width",  "Petal.Length"),
          dep.var.labels = depvar_label,
          covariate.labels = covar_labels,
          add.lines = list(c("Species FE", "No", "No", "Yes")),
          omit.stat = c("ser"),
          digits = 2,
          header = F)
```


\center \huge Thank you!  
  
# Appendix

## Appendix - Save your data to .csv

To export our data in .csv format we can use the `write.csv()` function. There other ways, but this is often the most straightforward. 

Here's the basic syntax:

`write.csv(x, file = "", sep = ",", row.names = TRUE)`

 * __x__:	the object to be written
 * __file__: where to save the table, i.e., the file path including the file name
 * __sep__: the field separator of the csv, Excel's default is comma
 * __row.names__: either a logical value indicating whether the row names of x are to be written along with x, or a character vector of row names to be written


## Appendix - Save your data to .csv

You can write the following code:

```{r, eval = F}
  write.csv(whr,
            file = file.path(...,"whr.csv"),
            row.names = F)

```

It is important to specify the `row.names` as `FALSE` since the function default is `TRUE`. There are situations when saving row names might make sense, but normally that's nor the case for data.frames.

## Appendix - Formulas

Formulas are a way of describing a relationship between variables or objects. They work as inputs for several functions, notably regression functions.


### We can create formulas by using the formula function
```{r}
# or Formula function yield same results
formula1 <- formula(y ~ x1 + x2)
formula1
```



## Appendix - Formulas

The most basic structure of a formula is actually just the tilde symbol ~ and at least one right-hand variable.

### You can also covert strings to create formulas
```{r}
# or Formula function yield same results
formula2 <- as.formula("~ x1")
formula2
```

## Appendix - Formulas

Note that values that assigned to the symbols in the formula are not accessed when the formula is created.

Alternatively, if you write an expression containing a tilde R already understands it as a formula.

### Just using the tilde
```{r}

formula3 <- y ~ x1 + z1
formula3
```


